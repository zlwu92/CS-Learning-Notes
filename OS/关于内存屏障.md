若程序在执行的实际内存访问顺序和代码编写的访问顺序不一致，会导致 内存乱序访问！

内存乱序访问的出现是为了 **提高程序执行时的效率**。

内存乱序访问主要发生在如下两个阶段：
1. 编译时，编译器优化导致内存乱序访问；（可通过barrier函数来规避）
2. 运行时，多个cpu间交互引起的内存乱序访问。

使用内存屏障指令，存储器访问指令被分成数据指令+同步指令，其中weak consistency内存模型就是基于内存屏障指令。

内存屏障指令的基本原则是：
- 所有在内存屏障指令之前的data access必须在之前完成；
- 所有在内存屏障指令之后的data access必须等内存屏障指令执行完；
- 多条内存屏障指令是按顺序执行的。